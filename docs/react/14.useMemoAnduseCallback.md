---
title: useMemo和useCallback
order: 13
group:
  title: react生态
  order: 0
---

## useMemo

useMemo 接受两个参数：

- 需要执行的一些计算处理工作，包裹在一个函数中
- 一个依赖数组

在组件挂载的过程中，当这个组件第一次被渲染时，React 都会调用这个函数来执行这段计算逻辑，计算所有的质数。无论我们从这个函数中返回什么值，都会分配给 allPrimes 变量。

然而，对于每一个后续的渲染，React 都要从以下两种情况中做出选择：

- 再次调用 useMemo 中的计算函数，重新计算数值
- 重复使用上一次已经计算出来的数据

为了做出一个正确的选择，React 会判断你传入的依赖数组，这个数组中的每个变量是否在两次渲染间 值是否改变了 ，如果发生了改变，就重新执行计算的逻辑去获取一个新的值，否则不重新计算，直接返回上一次计算的值。

useMemo 本质上就像一个小的缓存，而依赖数组就是缓存的失效策略。

在上面的例子中，其实本质上是在说 “只有当 selectedNum 的值变化时才重新计算质数列表“。 当组件因为其他情况重新渲染，例如状态 time 的值改变了，useMemo 就会忽略这个计算函数，直接返回之前缓存的值。

这种缓存的过程通常被称为 memoization，这就是为什么这个钩子被称为 “useMemo”。

## 参考链接

- [【React】1630- 不用 useMemo 和 useCallback 行不行？](https://mp.weixin.qq.com/s/-5ntE3gFb-w0wtAILyTTNg)
