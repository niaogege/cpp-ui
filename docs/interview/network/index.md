---
title: 总览
order: 0
group:
  order: 2
  title: 网络
  path: /interview/network
nav:
  order: 3
  title: 'interview'
  path: /interview
---

## 工程师中的基本功:问题积累

- [http1.x/http2.x/](./network/http.md)
- [http3.0](./network/http3.md)
- [https](./https.md)
- udp/tcp
- 强缓存/协商缓存
- 代理缓存
- DDOS
- http 队头阻塞问题，如何解决(1.使用多个域名 2.http2.0 多路复用)
- TCP 队头阻塞问题 如何解决
- TCP 三次握手，每一次失败会怎么样

## 基础的面试题

- 1.http1.0/http1.1/http2.0 之间的区别
- 2.如何理解 http2.0 中的多路复用
- 3.http3.0 基于 UDO 协议，如何保证传输可靠性?
- 4.说说 https 的握手过程
- 5.https 是如何保证安全的，又是如何保证不被中间人攻击的
- 6.说说你对三次握手和四次挥手的理解
- 7.TCP 和 UDP 区别
- 8.说说 TCP/IP 协议的了解
- 9.说下 websocket 原理
- 10.websocket 和 http 区别
- 11.跨域的时候如何处理 cookie,如何设置 cookie 保证只在 https 时携带
- 12.POST 请求中的 content-type 有哪几种
- 13.cache-control 常见有哪些配置
- 14.如何理解 HTTP 代理
- 15.DNS 劫持
-
-
-
- 19.什么是 dns 污染

## 1.http1.0/http1.1/http2.0 之间的区别

### http1.1

keep-alive: 所谓长连接，即在 HTTP 请求建立 TCP 连接时，请求结束，TCP 连接不断开，继续保持一段时间（timeout），在这段时间内，同一客户端向服务器发送请求都会复用该 TCP 连接，并重置 timeout 时间计数器，在接下来 timeout 时间内还可以继续复用 TCP.

### 为啥要引入多路复用

HTTP/1.x 虽然引入了 keep-alive 长连接，但它每次请求必须等待上一次响应之后才能发起，所以，在 HTTP/1.1 中提出了管道机制（默认不开启），下一次的请求不需要等待上一个响应来之后再发送，但这要求服务端必须按照请求发送的顺序返回响应，当顺序请求多个文件时，其中一个请求因为某种原因被阻塞时，在后面排队的所有请求也一并被阻塞，这就是队头阻塞 (Head-Of-Line Blocking) 人们采取了很多方法去解决，例如使用**域名切片**、引入雪碧图、**将小图内联**等，但都没有从根本上解决问题， HTTP/2 是怎么做的喃？

- 首先它引入了 帧（frame）和流（stream），因为 HTTP/1.x 是基于文本的，因为是文本，就导致了它必须是个整体，在传输是不可切割的，只能整体去传
- 既然，HTTP/2 是基于二进制流的，它就可以把 HTTP 消息分解为独立的帧，交错发送，然后在另一端通过帧中的**标识重新组装**，这就是多路复用
- 这就实现了在 同一个 TCP 连接中，同一时刻可以发送多个请求和响应，且不用按照顺序一一对应，即使某个请求任务耗时严重，也不会影响到其它连接的正常执行

### http1.0/http1.x 三点安全性问题

- 身份校验
- 数据安全性
- 数据完整性

## 2.如何理解 http2.0 中的多路复用

多路复用：同一个 TCP 连接中，同一时刻可以发送多个请求和响应，且**不用按照顺序**一一对应，即使某个请求任务耗时严重，也不会影响到其它连接的正常执行

> 单个 TCP 连接同一时刻可以发送多个请求和响应

## 3.http3.0 基于 UDO 协议，如何保证传输可靠性?

HTTP/3 使用的底层传输协议 QUIC 是基于 UDP 的，因此需要在应用层实现可靠的数据传输。QUIC 协议使用了以下几种机制来保证数据的可靠性：

1.连接迁移：QUIC 允许在网络切换或 IP 变更时迁移连接，而不需要重新建立新的连接，从而避免了连接中断和数据丢失的问题。

2.可靠的流控制：QUIC 在每个流上都实现了可靠的流控制机制，可以根据发送方和接收方的负载情况动态调整数据发送速率，从而优化传输效率和可靠性。

3.数据重传：QUIC 中每个数据包都带有唯一标识符（Packet Number），接收方可以根据这个标识符进行数据包的确认和重传，以保证数据传输的可靠性。

4.拥塞控制：QUIC 采用了基于 TCP 的拥塞控制机制，可以根据网络拥塞程度自适应调整发送速率，以避免网络拥塞和丢包等问题。

## 4.说说 https 的握手过程

## 5.https 是如何保证安全的，又是如何保证不被中间人攻击的

HTTPS 是一种基于 TLS/SSL 协议的安全传输协议，它可以通过加密和认证等措施来保护数据传输过程中的安全性和隐私性。其主要保证方式如下：

- 加密传输：使用公钥加密技术对数据进行加密，并使用私钥进行解密，以保证在传输过程中数据不会被窃取、篡改或伪造。

- 身份认证：使用数字证书对服务器和客户端身份进行认证，防止恶意攻击者伪装成合法用户或服务器进行攻击。

- 完整性校验：使用消息摘要算法对传输数据进行校验，确保数据的完整性和准确性，防止数据在传输过程中被篡改或损坏。

## 6.说说你对三次握手和四次挥手的理解

TCP 三次握手，其实就是建立一个 TCP 连接，客户端与服务器交互需要 3 个数据包。握手的主要作用就是为了确认双方的接收和发送能力是否正常，初始序列号，交换窗口大小等信息。

### 三次握手

- 第一次握手：客户端向服务端发起一个 SYN 请求包，包含客户端使用的端口号和初始序列号，随之客户端进入 SYN_SENT 状态，等待服务端响应

- 第二次握手：服务端收到客户端发来的 SYN 请求包，知道客户端想要建立连接，于是向客户端发送一个包含确认号和服务端自己的处事序列号，然后服务端进入 SYN_RCVD 状态

- 第三次握手：客户端收到服务端返回的 SYN 请求包和 ACK 确认包之后，再次向服务端发送一个包(包含确认号 ack/seq),随之客户端进入 ESTABLISHED 状态，等待服务器收到客户端发送的 ACK 包之后，服务端也会进入 ESTABLISHED 状态，完成三次握手。

#### 四次挥手

当我们的应用程序不需要数据通信了，就会发起断开 TCP 连接。建立一个连接需要三次握手，而终止一个连接需要经过四次挥手

- 第一次挥手：客户端向服务端发送 FIN+ACK 表示想结束本次连接，随之客户端进入 FIN_WAIT 状态

- 第二次挥手：服务端收到 FIN 包之后，发出确认包 ACK,带上自己的初始序列号，服务端进入 CLOSE_WAIT 状态。这个时候客户端已经没有数据要发送了，不过服务器端有数据发送的话，客户端依然需要接收。客户端接收到服务器端发送的 ACK 后，进入了 FIN_WAIT_2 状态。

- 第三次挥手：服务端可能还有未发送完的数据，所以服务端还再发送一个 ACK+FIN 进行最后的确认，此时没有一来一回,服务器此时进入了 LAST_ACK 状态

- 第四次挥手：客户端收到服务端给的 FIN 包之后，会向服务端发送一个 ACK 进行最后的确认 m，随之客户端进入 TIME_WAIT 状态，注意此时 TCP 还没完全释放，必须等待 2MSL,才进入 CLOSE 状态，而服务器端收到客户端的确认包 ACK 后就进入了 CLOSED 状态，可以看出服务器端结束 TCP 连接的时间要比客户端早一些。

## 7.UDP 和 TCP 区别

TCP（传输控制协议）和 UDP（用户数据报协议）是两种常见的网络传输协议。它们之间的主要区别如下：

连接方式：TCP 是面向连接的协议，需要在通信前建立连接，而 UDP 是无连接的协议，可以直接发送数据包。

可靠性：TCP 保证传输数据的可靠性，能够保证所有数据到达目的地且顺序正确；UDP 不保证传输数据的可靠性，可能会出现数据丢失或乱序等问题。

开销：TCP 在传输过程中要维护连接状态、进行流量控制、拥塞控制等操作，因此开销较大；UDP 没有这些机制，传输开销较小。

速度：由于 TCP 需要保证数据的可靠性，因此传输速度可能会受到一定的影响；UDP 没有这个限制，传输速度快。

适用场景：TCP 适用于对可靠性要求较高的应用场景，如文件传输、邮件传输等；而 UDP 适用于实时性要求较高的应用场景，如语音、视频、游戏等。

TCP 和 UDP 在连接方式、可靠性、开销、速度和适用场景等方面都有所不同。在实际应用中，需要根据具体的需求和场景选择合适的网络传输协议。

## 10。TCP 和 websocket 区别

## 11.跨域如何处理 cookie

### 跨域本质是浏览器基于同源策略的一种安全手段

同源策略（Sameoriginpolicy），是一种约定，它是浏览器最核心也最基本的安全功能

所谓同源（即指在同一个域）具有以下三个相同点:协议相同（protocol）/ 主机相同（host）/端口相同（port）反之非同源请求，也就是协议、端口、主机其中一项不相同的时候，这时候就会产生跨域.

## 14。如何理解 HTTP 代理

我们知道在 HTTP 是基于**请求-响应**模型的协议，一般由客户端发请求，服务器来进行响应。

当然，也有特殊情况，就是代理服务器的情况。引入代理之后，作为代理的服务器相当于一个中间人的角色，对于客户端而言，表现为服务器进行响应；而对于源服务器，表现为客户端发起请求，具有双重身份那代理服务器到底是用来做什么的呢？

功能

- 负载均衡。客户端的请求只会先到达代理服务器，后面到底有多少源服务器，IP 都是多少，客户端是不知道的。因此，这个代理服务器可以拿到这个请求之后，可以通过特定的算法分发给不同的源服务器，让各台源服务器的负载尽量平均。当然，这样的算法有很多，包括随机算法、轮询、一致性 hash、LRU``(最近最少使用)等等
- 保障安全。利用心跳机制监控后台的服务器，一旦发现故障机就将其踢出集群。并且对于上下行的数据进行过滤，对非法 IP 限流，这些都是代理服务器的工作。
- 缓存代理。将内容缓存到代理服务器，使得客户端可以直接从代理服务器获得而不用到源服务器那里。

相关头部字段：via/X-Forwarded-For/X-Real-IP

## 15.DNS 劫持

在正常环境下，用户的每一个上网请求会通过 DNS 解析指向到与之相匹配的 IP 地址，从而完成一次上网行为。DNS 作为应用层协议，主要是为其他应用层协议工作的，包括不限于 HTTP、SMTP、FTP，用于将用户提供的主机名解析为 IP 地址

常见 DNS 劫持手段又有哪些？

- 利用 DNS 服务器进行 DDoS 攻击

## 16.Ddos 攻击 (SYN/TCP 泛洪攻击)

**分布式**拒绝服务攻击（Distributed Denial of Service）: 是指处于不同位置的**多个攻击者**同时向一个或数个目标发动攻击。由于攻击的发出点是分布在不同地方的，这类攻击称为分布式拒绝服务攻击

SYN Flood 是一种利用 TCP 协议缺陷，发送大量伪造的 TCP 连接请求，从而使目标服务器资源耗尽的攻击方式。如果客户端只发起第一次握手，而不响应服务端的第二次握手，那么这条连接就处于半连接状态，服务端会维持这条连接一段时间（SYN Timeout）并不断地重试。但攻击者大量的模拟这种情况，就会沾满整个服务端的连接符号表，并消耗大量的 CPU 资源进行重试操作。而对于 SNY Flood 的防御目前有两种常见的方式，一种是算短 SYN Timeout，另一种是设置 SYN Cookie，并开辟一个数组存放 Cookie，单连接没有真正建立时，不去占用连接符号表。

### DDOS 防御策略

DDos 的防御主要有两种，一种是针对**流量带宽**，一种是针对**服务端资源**。流量带宽一般需要通过运营商采用 ISP 黑洞，近源清洗等策略，在源头（即攻击者所在的网段）进行拦截，而不是等到所有的细流汇聚成猛水时才进行拦截。

服务端可采用：利用安全水印技术，客户端和服务端协商好一套签名算法，客户端生成签名，服务端验证签名，同时增加一些时间戳参数，保证攻击方无效

## 17.怎么做 tcp 流量控制

TCP 流量控制是指在 TCP 连接中**控制数据的发送速率**，以避免网络拥塞和数据丢失。以下是一些常见的 TCP 流量控制方法：

- 滑动窗口：TCP 协议中的滑动窗口机制可以控制发送方发送数据的速率。接收方会告诉发送方它可以接收多少数据，发送方则根据接收方的反馈来控制发送速率。

- 慢启动：TCP 连接建立时，发送方会采用慢启动算法来逐渐增加发送速率，以避免网络拥塞。慢启动算法会根据网络的拥塞程度来调整发送速率。

- 拥塞避免：当网络拥塞时，TCP 会采用拥塞避免算法来控制发送速率。拥塞避免算法会根据网络的拥塞程度来调整发送速率，以避免网络拥塞。

- 拥塞控制：当网络拥塞时，TCP 会采用拥塞控制算法来控制发送速率。拥塞控制算法会根据网络的拥塞程度来调整发送速率，以避免网络拥塞。

- 带宽限制：TCP 流量控制还可以通过限制带宽来控制发送速率。可以使用网络设备或软件来限制 TCP 连接的带宽。

## 18.怎么做 tcp 拥塞控制

TCP 拥塞控制是一种**网络流量控制技术**，用于防止网络拥塞和保证网络的可靠性。以下是一些 TCP 拥塞控制的方法：

慢启动：在 TCP 连接开始时，发送方会以较慢的速度发送数据，然后逐渐增加发送速度，以避免网络拥塞。

拥塞避免：一旦发送方确定网络拥塞，它会减少发送速度，以避免进一步的拥塞。

快速重传：当接收方收到重复的数据包时，它会立即向发送方发送一个重复确认，以便发送方可以快速重新发送丢失的数据包。

快速恢复：当发送方收到重复确认时，它会将拥塞窗口减半，但不会像拥塞避免一样减少发送速度。这可以帮助发送方更快地恢复到先前的发送速度。

拥塞控制算法：TCP 拥塞控制算法包括 Reno、NewReno、Cubic 等，它们使用不同的拥塞控制策略来避免网络拥塞。

总之，TCP 拥塞控制是一个复杂的过程，**需要发送方和接收方之间的协作来保证网络的可靠性和性能**

## 19.什么是 dns 污染

DNS 污染是指恶意攻击者通过篡改**DNS 服务器的缓存或者 DNS 响应报文**，将用户请求的合法域名解析到错误的 IP 地址，从而导致用户访问到错误的网站或者无法访问正常的网站。这种攻击方式可以用来实施钓鱼、欺诈、窃取用户信息等恶意行为。

## 杂谈

- protocol-relative URL，暂且可译做**协议相对** URL，即 '//baidu.com'根据当前的 url 访问看是 https or http

### 参考

- [三元的(建议收藏)TCP 协议灵魂之问，巩固你的网路底层基础](https://mp.weixin.qq.com/s/hy-X0sY05_UK8G_SB4jXoQ)
- [DDoS 攻击与防御](https://juejin.cn/post/7115593880757616648)
