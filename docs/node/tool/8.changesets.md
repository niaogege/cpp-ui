---
title: 使用changesets
order: 8
group:
  title: 工具
  order: 6
  path: /node/tool
nav:
  order: 1
  title: 'node'
  path: /node
---

changesets 是一个在 **Monorepo 项目下进行版本管理和发布和 Changelog 文件管理**的工具。changesets 会根据当前分支基于主分支的变化，筛选出需要变更的包，然后开发者可以根据实际场景更新包版本（遵循 **semver** 规范），填写 Changelog 信息，最后发布变更的包。

> [semver](https://juejin.cn/post/7122240572491825160)

### 安装和初始化 changeset

项目根目录执行

```shell
pnpm i -Dw @changesets/cli
```

changeset 初始化

```shell
pnpm changeset init
```

这时候，你会发现，项目根目录下多了一个 **.changeset** 目录，其中 config.json 是 changesets 的配置文件。请注意，我们需要把这个目录一起提交到 git 上。

### 初始化发包

在 monorepo 项目中 两个子包版本号都是 0.0.0，我们可以在项目根目录下直接运行 pnpm changeset publish 为子包发布第一个版本。发布完成后，我们完成了 monorepo 项目的初始化，我们可以把这个改动合并到你的主分支上并提交到远程仓库中。

### 发布正式包

执行 pnpm changeset

> 如果想更换版本号升级类型： major、minor、patch,在第一次选择完包名之后(如下图)按回车健而不是空格键

![如何选minor/patch](https://www.bythewayer.com/img/changesetFirst.webp)

- 选择发布的包名
- 选择主版本 次版本 修订号
- 描述此次变更信息

- pnpm changeset 选择要发布的包
- pnpm changeset version 修改包为正式版本
- pnpm changeset publish 发布

### 发布测试版本 Prerelease

如何进入到 Prerelease 模式呢，执行

```shell
pnpm changeset pre enter <tag>
pnpm changeset pre enter alpha   # 发布 alpha 版本
pnpm changeset pre enter beta    # 发布 beta 版本
pnpm changeset pre enter rc      # 发布 rc 版本
```

| 名称  | 功能                                                                                    |
| ----- | --------------------------------------------------------------------------------------- |
| alpha | 是内部测试版，一般不向外部发布，会有很多 Bug，一般只有测试人员使用                      |
| beta  | 也是测试版，这个阶段的版本会一直加入新的功能。在 Alpha 版之后推出                       |
| rc    | Release Candidate 系统平台上就是发行候选版本。RC 版不会再加入新的功能了，主要着重于除错 |

完成版本发布之后，退出 Prereleases 模式：

```shell
pnpm changeset pre exit
```

### 走一个实际案例

```shell

pnpm changeset pre enter beta

pnpm changeset
pnpm changeset version
pnpm changeset publish

```
