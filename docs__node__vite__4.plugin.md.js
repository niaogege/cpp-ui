(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[116],{B16k:function(e,n,t){"use strict";t.r(n);var a=t("q1tI"),l=t.n(a),r=t("dEAq"),o=t("H1Ra"),c=l.a.memo((e=>{e.demos;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("p",null,"\u91cd\u70b9\u5173\u6ce8 Vite \u72ec\u6709\u7684\u90e8\u5206\u4ee5\u53ca\u548c Rollup \u6240\u533a\u522b\u7684\u90e8\u5206"),l.a.createElement("h3",{id:"\u901a\u7528-hook"},l.a.createElement(r["AnchorLink"],{to:"#\u901a\u7528-hook","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u901a\u7528 hook"),l.a.createElement("p",null,"Vite \u5f00\u53d1\u9636\u6bb5\u4f1a\u6a21\u62df Rollup \u7684\u884c\u4e3a: \u5176\u4e2d Vite \u4f1a\u8c03\u7528\u4e00\u7cfb\u5217\u4e0e Rollup \u517c\u5bb9\u7684\u94a9\u5b50\uff0c\u8fd9\u4e2a\u94a9\u5b50\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5:"),l.a.createElement("ul",null,l.a.createElement("li",null,"\u670d\u52a1\u5668\u542f\u52a8\u9636\u6bb5: ",l.a.createElement("strong",null,"options \u548c buildStart"),"\u94a9\u5b50\u4f1a\u5728\u670d\u52a1\u542f\u52a8\u65f6\u88ab\u8c03\u7528\u3002"),l.a.createElement("li",null,"\u8bf7\u6c42\u54cd\u5e94\u9636\u6bb5: \u5f53\u6d4f\u89c8\u5668\u53d1\u8d77\u8bf7\u6c42\u65f6\uff0cVite \u5185\u90e8\u4f9d\u6b21\u8c03\u7528",l.a.createElement("strong",null,"resolveId\u3001load \u548c transform"),"\u94a9\u5b50\u3002"),l.a.createElement("li",null,"\u670d\u52a1\u5668\u5173\u95ed\u9636\u6bb5: Vite \u4f1a\u4f9d\u6b21\u6267\u884c",l.a.createElement("strong",null,"buildEnd \u548c closeBundle"),"\u94a9\u5b50\u3002")),l.a.createElement("p",null,"\u9664\u4e86\u4ee5\u4e0a\u94a9\u5b50\uff0c\u5176\u4ed6 Rollup \u63d2\u4ef6\u94a9\u5b50(\u5982",l.a.createElement("strong",null,"moduleParsed\u3001renderChunk"),")\u5747\u4e0d\u4f1a\u5728 Vite \u5f00\u53d1\u9636\u6bb5\u8c03\u7528\u3002\u800c",l.a.createElement("strong",null,"\u751f\u4ea7\u73af\u5883\u4e0b\uff0c\u7531\u4e8e Vite \u76f4\u63a5\u4f7f\u7528 Rollup\uff0cVite \u63d2\u4ef6\u4e2d\u6240\u6709 Rollup \u7684\u63d2\u4ef6\u94a9\u5b50\u90fd\u4f1a\u751f\u6548"),"\u3002"),l.a.createElement("h3",{id:"vite-\u72ec\u6709-hooks"},l.a.createElement(r["AnchorLink"],{to:"#vite-\u72ec\u6709-hooks","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"vite \u72ec\u6709 hooks"),l.a.createElement("h4",{id:"config"},l.a.createElement(r["AnchorLink"],{to:"#config","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"config"),l.a.createElement("p",null,"Vite \u5728\u8bfb\u53d6\u5b8c\u914d\u7f6e\u6587\u4ef6\uff08\u5373 vite.config.ts\uff09\u4e4b\u540e\uff0c\u4f1a\u62ff\u5230\u7528\u6237\u5bfc\u51fa\u7684\u914d\u7f6e\u5bf9\u8c61\uff0c\u7136\u540e\u6267\u884c config \u94a9\u5b50\u3002\u5728\u8fd9\u4e2a\u94a9\u5b50\u91cc\u9762\uff0c\u4f60\u53ef\u4ee5\u5bf9\u914d\u7f6e\u6587\u4ef6\u5bfc\u51fa\u7684\u5bf9\u8c61\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u64cd\u4f5c\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a:"),l.a.createElement(o["a"],{code:"// \u8fd4\u56de\u90e8\u5206\u914d\u7f6e\uff08\u63a8\u8350\uff09\nconst editConfigPlugin = () => ({\n  name: 'vite-plugin-modify-config',\n  config: () => ({\n    alias: {\n      react: require.resolve('react'),\n    },\n  }),\n});",lang:"js"}),l.a.createElement("h4",{id:"\u8bb0\u5f55\u6700\u7ec8\u914d\u7f6e-configresolved"},l.a.createElement(r["AnchorLink"],{to:"#\u8bb0\u5f55\u6700\u7ec8\u914d\u7f6e-configresolved","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u8bb0\u5f55\u6700\u7ec8\u914d\u7f6e: configResolved"),l.a.createElement("p",null,"Vite \u5728\u89e3\u6790\u5b8c\u914d\u7f6e\u4e4b\u540e\u4f1a\u8c03\u7528 configResolved \u94a9\u5b50\uff0c\u8fd9\u4e2a\u94a9\u5b50\u4e00\u822c\u7528\u6765\u8bb0\u5f55\u6700\u7ec8\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u800c\u4e0d\u5efa\u8bae\u518d\u4fee\u6539\u914d\u7f6e\uff0c\u7528\u6cd5\u5982\u4e0b\u56fe\u6240\u793a:"),l.a.createElement(o["a"],{code:"const plugin = () => {\n  let config;\n  return {\n    name: 'plugin-xx',\n    configResolved(resolvedConfig) {\n      // \u8bb0\u5f55\u6700\u7ec8\u914d\u7f6e\n      config = resolvedConfig;\n    },\n    // \u5176\u4ed6\u94a9\u5b50\u4e2d\u9614\u4ee5\u8bbf\u95ee\u5230\u8be5\u914d\u7f6e\n    tranform(code, id) {\n      console.log(code);\n    },\n  };\n};",lang:"js"}),l.a.createElement("h4",{id:"\u83b7\u53d6-dev-server-\u5b9e\u4f8b-configureserver"},l.a.createElement(r["AnchorLink"],{to:"#\u83b7\u53d6-dev-server-\u5b9e\u4f8b-configureserver","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u83b7\u53d6 Dev Server \u5b9e\u4f8b: configureServer"),l.a.createElement("p",null,"\u8fd9\u4e2a\u94a9\u5b50\u4ec5\u5728",l.a.createElement("strong",null,"\u5f00\u53d1\u9636\u6bb5"),"\u4f1a\u88ab\u8c03\u7528\uff0c\u7528\u4e8e\u6269\u5c55 Vite \u7684 Dev Server\uff0c\u4e00\u822c\u7528\u4e8e\u589e\u52a0\u81ea\u5b9a\u4e49 server \u4e2d\u95f4\u4ef6\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a:"),l.a.createElement(o["a"],{code:"const myPlugin = () => {\n  return {\n    name: 'config-server',\n    configureServer(server) {\n      // \u59ff\u52bf 1: \u5728 Vite \u5185\u7f6e\u4e2d\u95f4\u4ef6\u4e4b\u524d\u6267\u884c\n      server.middlewares.use((req, res, next) => {\n        // \u81ea\u5b9a\u4e49\u8bf7\u6c42\u5904\u7406\u903b\u8f91\n      });\n      // \u59ff\u52bf 2: \u5728 Vite \u5185\u7f6e\u4e2d\u95f4\u4ef6\u4e4b\u540e\u6267\u884c\n      return () => {\n        server.middlewares.use((req, res, next) => {\n          // \u81ea\u5b9a\u4e49\u8bf7\u6c42\u5904\u7406\u903b\u8f91\n        });\n      };\n    },\n  };\n};",lang:"js"}),l.a.createElement("h4",{id:"\u8f6c\u6362-html-\u5185\u5bb9-transformindexhtml"},l.a.createElement(r["AnchorLink"],{to:"#\u8f6c\u6362-html-\u5185\u5bb9-transformindexhtml","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u8f6c\u6362 HTML \u5185\u5bb9: transformIndexHtml"),l.a.createElement("p",null,"\u8fd9\u4e2a\u94a9\u5b50\u7528\u6765\u7075\u6d3b\u63a7\u5236 HTML \u7684\u5185\u5bb9\uff0c\u4f60\u53ef\u4ee5\u62ff\u5230\u539f\u59cb\u7684 html \u5185\u5bb9\u540e\u8fdb\u884c\u4efb\u610f\u7684\u8f6c\u6362:"),l.a.createElement(o["a"],{code:"const htmlPlugin = () => {\n  return {\n    name: 'html-transform',\n    transformIndexHtml(html) {\n      return html.replace(\n        /<title>(.*?)</title>/,\n        `<title>\u6362\u4e86\u4e2a\u6807\u9898</title>`\n      )\n    }\n  }\n}\n// \u4e5f\u53ef\u4ee5\u8fd4\u56de\u5982\u4e0b\u7684\u5bf9\u8c61\u7ed3\u6784\uff0c\u4e00\u822c\u7528\u4e8e\u6dfb\u52a0\u67d0\u4e9b\u6807\u7b7e\nconst htmlPlugin = () => {\n  return {\n    name: 'html-transform',\n    transformIndexHtml(html) {\n      return {\n        html,\n        // \u6ce8\u5165\u6807\u7b7e\n        tags: [\n          {\n            // \u653e\u5230 body \u672b\u5c3e\uff0c\u53ef\u53d6\u503c\u8fd8\u6709`head`|`head-prepend`|`body-prepend`\uff0c\u987e\u540d\u601d\u4e49\n            injectTo: 'body',\n            // \u6807\u7b7e\u5c5e\u6027\u5b9a\u4e49\n            attrs: { type: 'module', src: './index.ts' },\n            // \u6807\u7b7e\u540d\n            tag: 'script',\n          },\n        ],\n      }\n    }\n  }\n}",lang:"js"}),l.a.createElement("h4",{id:"\u70ed\u66f4\u65b0\u5904\u7406-handlehotupdate"},l.a.createElement(r["AnchorLink"],{to:"#\u70ed\u66f4\u65b0\u5904\u7406-handlehotupdate","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u70ed\u66f4\u65b0\u5904\u7406: handleHotUpdate"),l.a.createElement("p",null,"\u8fd9\u4e2a\u94a9\u5b50\u4f1a\u5728 Vite \u670d\u52a1\u7aef\u5904\u7406\u70ed\u66f4\u65b0\u65f6\u88ab\u8c03\u7528\uff0c\u4f60\u53ef\u4ee5\u5728\u8fd9\u4e2a\u94a9\u5b50\u4e2d\u62ff\u5230\u70ed\u66f4\u65b0\u76f8\u5173\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u8fdb\u884c\u70ed\u66f4\u6a21\u5757\u7684\u8fc7\u6ee4\uff0c\u6216\u8005\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u70ed\u66f4\u5904\u7406\u3002"),l.a.createElement(o["a"],{code:"const handleHmrPlugin = () => {\n  return {\n    async handleHotUpdate(ctx) {\n      // \u9700\u8981\u70ed\u66f4\u7684\u6587\u4ef6\n      console.log(ctx.file);\n      // \u9700\u8981\u70ed\u66f4\u7684\u6a21\u5757\uff0c\u5982\u4e00\u4e2a Vue \u5355\u6587\u4ef6\u4f1a\u6d89\u53ca\u591a\u4e2a\u6a21\u5757\n      console.log(ctx.modules);\n      // \u65f6\u95f4\u6233\n      console.log(ctx.timestamp);\n      // Vite Dev Server \u5b9e\u4f8b\n      console.log(ctx.server);\n      // \u8bfb\u53d6\u6700\u65b0\u7684\u6587\u4ef6\u5185\u5bb9\n      console.log(await read());\n      // \u81ea\u884c\u5904\u7406 HMR \u4e8b\u4ef6\n      ctx.server.ws.send({\n        type: 'custom',\n        event: 'special-update',\n        data: { a: 1 },\n      });\n      return [];\n    },\n  };\n};\n\n// \u524d\u7aef\u4ee3\u7801\u4e2d\u52a0\u5165\nif (import.meta.hot) {\n  import.meta.hot.on('special-update', (data) => {\n    // \u6267\u884c\u81ea\u5b9a\u4e49\u66f4\u65b0\n    // { a: 1 }\n    console.log(data);\n    window.location.reload();\n  });\n}",lang:"js"}),l.a.createElement("h4",{id:"\u603b\u7ed3-vite-\u72ec\u6709\u94a9\u5b50"},l.a.createElement(r["AnchorLink"],{to:"#\u603b\u7ed3-vite-\u72ec\u6709\u94a9\u5b50","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u603b\u7ed3 vite \u72ec\u6709\u94a9\u5b50"),l.a.createElement("ul",null,l.a.createElement("li",null,"config: \u7528\u6765\u8fdb\u4e00\u6b65\u4fee\u6539\u914d\u7f6e\u3002"),l.a.createElement("li",null,"configResolved: \u7528\u6765\u8bb0\u5f55\u6700\u7ec8\u7684\u914d\u7f6e\u4fe1\u606f\u3002"),l.a.createElement("li",null,"configureServer: \u7528\u6765\u83b7\u53d6 Vite Dev Server \u5b9e\u4f8b\uff0c\u6dfb\u52a0\u4e2d\u95f4\u4ef6\u3002"),l.a.createElement("li",null,"transformIndexHtml: \u7528\u6765\u8f6c\u6362 HTML \u7684\u5185\u5bb9\u3002"),l.a.createElement("li",null,"handleHotUpdate: \u7528\u6765\u8fdb\u884c\u70ed\u66f4\u65b0\u6a21\u5757\u7684\u8fc7\u6ee4\uff0c\u6216\u8005\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u70ed\u66f4\u65b0\u5904\u7406\u3002")),l.a.createElement("h3",{id:"hook-\u6267\u884c\u987a\u5e8f"},l.a.createElement(r["AnchorLink"],{to:"#hook-\u6267\u884c\u987a\u5e8f","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Hook \u6267\u884c\u987a\u5e8f"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("p",null,"\u670d\u52a1\u542f\u52a8\u9636\u6bb5: ",l.a.createElement("strong",null,"config\u3001configResolved\u3001options\u3001configureServer\u3001buildStart"))),l.a.createElement("li",null,l.a.createElement("p",null,"\u8bf7\u6c42\u54cd\u5e94\u9636\u6bb5: \u5982\u679c\u662f html \u6587\u4ef6\uff0c\u4ec5\u6267\u884c transformIndexHtml \u94a9\u5b50\uff1b\u5bf9\u4e8e\u975e HTML \u6587\u4ef6\uff0c\u5219\u4f9d\u6b21\u6267\u884c resolveId\u3001load \u548c transform \u94a9\u5b50\u3002\u76f8\u4fe1\u5927\u5bb6\u5b66\u8fc7 Rollup \u7684\u63d2\u4ef6\u673a\u5236\uff0c\u5df2\u7ecf\u5bf9\u8fd9\u4e09\u4e2a\u94a9\u5b50\u6bd4\u8f83\u719f\u6089\u4e86\u3002")),l.a.createElement("li",null,l.a.createElement("p",null,"\u70ed\u66f4\u65b0\u9636\u6bb5: \u6267\u884c ",l.a.createElement("strong",null,"handleHotUpdate")," \u94a9\u5b50\u3002")),l.a.createElement("li",null,l.a.createElement("p",null,"\u670d\u52a1\u5173\u95ed\u9636\u6bb5: \u4f9d\u6b21\u6267\u884c ",l.a.createElement("strong",null,"buildEnd \u548c closeBundle")," \u94a9\u5b50\u3002"))),l.a.createElement("h3",{id:"vite-\u63d2\u4ef6\u5f00\u53d1"},l.a.createElement(r["AnchorLink"],{to:"#vite-\u63d2\u4ef6\u5f00\u53d1","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"vite \u63d2\u4ef6\u5f00\u53d1")))}));n["default"]=e=>{var n=l.a.useContext(r["context"]),t=n.demos;return l.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.a.createElement(c,{demos:t})}}}]);